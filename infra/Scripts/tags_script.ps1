$TagInfo = Import-CSv -path $Env:BUILD_SOURCESDIRECTORY\infra\ConfigFiles\$Env\TagInfo.csv -Header 'ApplicationName', 'ApplicationID', 'AssetOwner', 'AssetOwnerEmail', 'AssetOwnerSSO', 'BuildBy', 'Business', 'Classification', 'CreatedDate', 'Criticality', 'Environment', 'FunctionalOwnerEmail', 'TagName', 'OwnedByEmail', 'OwnerBusinessUnit', 'SubBusiness', 'SupportGroup', 'SupportGroupDL'
$vm = Get-AzVM -Name "BHAZW02140007P"
$Tags = @{"Application Name"=$TagInfo[0].ApplicationName;"Application ID"= $TagInfo[0].ApplicationID;"Asset Owner"=$TagInfo[0].AssetOwner;"Asset Owner Email"=$TagInfo[0].AssetOwnerEmail;"Asset Owner SSO"=$TagInfo[0].AssetOwnerSSO;"Build By"=$TagInfo[0].BuildBy;"Business"=$TagInfo[0].Business;"Classification"=$TagInfo[0].Classification;"Created Date"=$TagInfo[0].CreatedDate;"Criticality"=$TagInfo[0].AssetOwner;"Environment"=$TagInfo[0].Environment;"Functional Owner Email"=$TagInfo[0].FunctionalOwnerEmail;"Name"=$TagInfo[0].TagName;"Owned By Email"=$TagInfo[0].OwnedByEmail;"Owner Business Unit"=$TagInfo[0].OwnerBusinessUnit;"Sub Business"=$TagInfo[0].SubBusiness;"Support Group"=$TagInfo[0].SupportGroup;"Support Group DL"=$TagInfo[0].SupportGroupDL}
New-AzTag -Tag $Tags -ResourceId $vm.Id -Verbose
